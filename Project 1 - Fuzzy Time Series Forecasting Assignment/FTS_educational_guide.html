<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fuzzy Time Series Forecasting - Complete Learning Guide</title>
    <style>
        /* ============================================
           CSS STYLES - DARK MODE BY DEFAULT
           ============================================
           We use CSS custom properties (variables) to make
           theming easier and more maintainable.
        */
        :root {
            /* Dark mode color palette */
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --bg-card: #1c2128;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-primary: #58a6ff;
            --accent-secondary: #238636;
            --accent-warning: #d29922;
            --accent-danger: #f85149;
            --border-color: #30363d;
            --code-bg: #0d1117;
            --highlight: #388bfd26;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 16px;
        }

        /* Layout containers */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header styles */
        header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border-bottom: 1px solid var(--border-color);
            padding: 40px 20px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--accent-primary), #a371f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Navigation */
        nav {
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 10px 0;
        }

        nav ul {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            list-style: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        nav a {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        nav a:hover {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
        }

        nav a.active {
            background-color: var(--accent-primary);
            color: #ffffff;
        }

        /* Main content area */
        main {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
            padding: 30px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        @media (max-width: 900px) {
            main {
                grid-template-columns: 1fr;
            }
            .sidebar {
                order: -1;
            }
        }

        /* Section styles */
        section {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        section h2 {
            color: var(--accent-primary);
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        section h3 {
            color: var(--text-primary);
            font-size: 1.3rem;
            margin: 25px 0 15px;
        }

        section h4 {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin: 20px 0 10px;
        }

        p {
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        /* Sidebar - Progress Tracker */
        .sidebar {
            position: sticky;
            top: 80px;
            height: fit-content;
        }

        .progress-tracker {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
        }

        .progress-tracker h3 {
            color: var(--accent-primary);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .progress-bar {
            background-color: var(--bg-tertiary);
            border-radius: 10px;
            height: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-bar-fill {
            background: linear-gradient(90deg, var(--accent-secondary), var(--accent-primary));
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .checklist {
            list-style: none;
        }

        .checklist li {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 5px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .checklist li:hover {
            background-color: var(--bg-tertiary);
        }

        .checklist input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-top: 2px;
            cursor: pointer;
            accent-color: var(--accent-secondary);
        }

        .checklist label {
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-secondary);
            flex: 1;
        }

        .checklist li.completed label {
            text-decoration: line-through;
            color: var(--text-muted);
        }

        /* Code blocks */
        pre {
            background-color: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 15px 0;
            font-size: 0.9rem;
        }

        code {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            color: var(--text-primary);
        }

        /* Inline code */
        p code, li code {
            background-color: var(--bg-tertiary);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            color: var(--accent-primary);
        }

        /* Info boxes */
        .info-box {
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid;
        }

        .info-box.concept {
            background-color: rgba(88, 166, 255, 0.1);
            border-color: var(--accent-primary);
        }

        .info-box.important {
            background-color: rgba(210, 153, 34, 0.1);
            border-color: var(--accent-warning);
        }

        .info-box.success {
            background-color: rgba(35, 134, 54, 0.1);
            border-color: var(--accent-secondary);
        }

        .info-box.warning {
            background-color: rgba(248, 81, 73, 0.1);
            border-color: var(--accent-danger);
        }

        .info-box-title {
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95rem;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background-color: var(--bg-tertiary);
            color: var(--accent-primary);
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: var(--bg-secondary);
        }

        /* Diagrams using ASCII/Box characters */
        .diagram {
            background-color: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre;
            overflow-x: auto;
            line-height: 1.4;
            color: var(--text-secondary);
            margin: 20px 0;
        }

        .diagram .highlight {
            color: var(--accent-primary);
        }

        .diagram .success {
            color: var(--accent-secondary);
        }

        .diagram .warning {
            color: var(--accent-warning);
        }

        /* Lists */
        ul, ol {
            margin: 15px 0 15px 30px;
        }

        li {
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        /* Interactive elements */
        .interactive-demo {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .interactive-demo h4 {
            color: var(--accent-primary);
            margin-bottom: 15px;
        }

        input[type="number"], input[type="text"], select {
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 1rem;
            width: 100%;
            margin-bottom: 10px;
        }

        input[type="number"]:focus, input[type="text"]:focus, select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--highlight);
        }

        button {
            background: linear-gradient(135deg, var(--accent-primary) 0%, #1f6feb 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button.secondary {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
        }

        button.secondary:hover {
            background: var(--border-color);
        }

        /* File explanation cards */
        .file-card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin: 15px 0;
            overflow: hidden;
        }

        .file-card-header {
            background-color: var(--bg-tertiary);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .file-card-header:hover {
            background-color: var(--border-color);
        }

        .file-icon {
            font-size: 1.5rem;
        }

        .file-name {
            font-family: monospace;
            color: var(--accent-primary);
            font-weight: bold;
        }

        .file-card-content {
            padding: 20px;
            display: none;
        }

        .file-card-content.expanded {
            display: block;
        }

        /* Math formulas */
        .formula {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px 20px;
            margin: 15px 0;
            font-family: 'Times New Roman', serif;
            font-size: 1.1rem;
            text-align: center;
            color: var(--text-primary);
        }

        /* Visualization canvas */
        .canvas-container {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        canvas {
            display: block;
            margin: 0 auto;
            background-color: var(--bg-primary);
            border-radius: 4px;
        }

        /* Footer */
        footer {
            background-color: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 30px 20px;
            text-align: center;
            color: var(--text-secondary);
            margin-top: 50px;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        section {
            animation: fadeIn 0.5s ease;
        }

        /* Utility classes */
        .text-center { text-align: center; }
        .text-muted { color: var(--text-secondary); }
        .mb-20 { margin-bottom: 20px; }
        .mt-20 { margin-top: 20px; }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            header h1 {
                font-size: 1.8rem;
            }
            section {
                padding: 20px;
            }
            nav a {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- ============================================
         HEADER SECTION
         ============================================ -->
    <header>
        <h1>ğŸ”® Fuzzy Time Series Forecasting</h1>
        <p>A comprehensive, beginner-friendly guide to understanding and implementing FTS models from scratch</p>
    </header>

    <!-- ============================================
         NAVIGATION
         ============================================ -->
    <nav>
        <ul>
            <li><a href="#overview" class="active">Overview</a></li>
            <li><a href="#concepts">Core Concepts</a></li>
            <li><a href="#algorithm">Algorithm</a></li>
            <li><a href="#implementation">Implementation</a></li>
            <li><a href="#files">File Structure</a></li>
            <li><a href="#demo">Interactive Demo</a></li>
            <li><a href="#results">Results</a></li>
        </ul>
    </nav>

    <!-- ============================================
         MAIN CONTENT AREA
         ============================================ -->
    <main>
        <div class="content">
            <!-- ==================== SECTION 1: OVERVIEW ==================== -->
            <section id="overview">
                <h2>ğŸ“– 1. What is This Project?</h2>
                
                <div class="info-box concept">
                    <div class="info-box-title">ğŸ’¡ The Big Picture</div>
                    <p>This project implements <strong>Fuzzy Time Series (FTS)</strong> forecasting â€” a technique that predicts future values based on patterns in historical data, using the concept of "fuzzy sets" from fuzzy logic.</p>
                </div>

                <h3>What Problem Does This Solve?</h3>
                <p>Imagine you want to predict tomorrow's temperature, next month's sales, or the spread of a disease. You have historical data, but the patterns aren't perfectly clear or crisp. That's where Fuzzy Time Series comes in!</p>
                
                <p><strong>Traditional methods</strong> treat data as exact numbers. But real-world data is often:</p>
                <ul>
                    <li>Uncertain or approximate</li>
                    <li>Following patterns that are "kind of" similar</li>
                    <li>Better described with words like "high", "medium", "low"</li>
                </ul>

                <p><strong>Fuzzy Time Series</strong> converts numbers into linguistic categories (like "Very Low", "Low", "Medium", "High", "Very High"), finds patterns in these categories, and uses those patterns to make predictions.</p>

                <h3>Real-World Analogy</h3>
                <div class="info-box success">
                    <div class="info-box-title">ğŸŒ¡ï¸ Weather Prediction Example</div>
                    <p>Instead of saying "If temperature is exactly 72Â°F today, it will be exactly 74Â°F tomorrow", FTS says:</p>
                    <p>"If temperature is <em>Warm</em> today, it will likely be <em>Warm</em> or <em>Slightly Warmer</em> tomorrow."</p>
                    <p>This is more natural and handles uncertainty better!</p>
                </div>

                <h3>Project Overview</h3>
                <table>
                    <tr>
                        <th>Aspect</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>Input</td>
                        <td>Time series data (a sequence of values over time)</td>
                    </tr>
                    <tr>
                        <td>Output</td>
                        <td>Predictions for future values</td>
                    </tr>
                    <tr>
                        <td>Method</td>
                        <td>First-Order FTS (FOFTS) and High-Order FTS (HOFTS)</td>
                    </tr>
                    <tr>
                        <td>Datasets</td>
                        <td>Mackey-Glass (chaotic), Influenza (real-world)</td>
                    </tr>
                    <tr>
                        <td>Evaluation</td>
                        <td>RMSE, MAE, MAPE metrics</td>
                    </tr>
                </table>
            </section>

            <!-- ==================== SECTION 2: CORE CONCEPTS ==================== -->
            <section id="concepts">
                <h2>ğŸ§  2. Core Concepts Explained</h2>

                <h3>2.1 What is a Time Series?</h3>
                <p>A <strong>time series</strong> is simply a sequence of values recorded over time. Examples:</p>
                <ul>
                    <li>Daily stock prices: [100, 102, 99, 105, 103, ...]</li>
                    <li>Monthly rainfall: [2.3, 1.8, 3.5, 4.2, 2.1, ...]</li>
                    <li>Hourly website visitors: [150, 180, 220, 195, ...]</li>
                </ul>

                <div class="diagram">
Time â†’   tâ‚    tâ‚‚    tâ‚ƒ    tâ‚„    tâ‚…    tâ‚†    tâ‚‡
         â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚
Value    100   102   99    105   103   108   110
         â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚
         â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
                   Historical Data            â†’ Future?
                </div>

                <h3>2.2 What is a Fuzzy Set?</h3>
                <p>In classical (crisp) logic, something either belongs to a set or it doesn't. Temperature is either "Hot" or "Not Hot".</p>
                
                <p>In <strong>fuzzy logic</strong>, things can <em>partially</em> belong to a set. A temperature of 75Â°F might be:</p>
                <ul>
                    <li>70% "Warm"</li>
                    <li>30% "Hot"</li>
                    <li>0% "Cold"</li>
                </ul>

                <div class="info-box concept">
                    <div class="info-box-title">ğŸ“Š Membership Function</div>
                    <p>A <strong>membership function</strong> defines HOW MUCH a value belongs to a fuzzy set. It outputs a number between 0 (doesn't belong) and 1 (fully belongs).</p>
                </div>

                <h4>Visualizing a Triangular Membership Function</h4>
                <div class="diagram">
Membership
Degree (Î¼)
    1.0 â”‚         â•±â•²
        â”‚        â•±  â•²
    0.5 â”‚       â•±    â•²
        â”‚      â•±      â•²
    0.0 â”‚â”€â”€â”€â”€â”€â•±â”€â”€â”€â”€â”€â”€â”€â”€â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€
            a    b    c         Value
            â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
            Parameters

For a value x:
- If x â‰¤ a: Î¼(x) = 0 (doesn't belong)
- If a < x â‰¤ b: Î¼(x) = (x-a)/(b-a) (rising slope)
- If b < x < c: Î¼(x) = (c-x)/(c-b) (falling slope)
- If x â‰¥ c: Î¼(x) = 0 (doesn't belong)
                </div>

                <h3>2.3 The Four Membership Function Types</h3>
                
                <div class="info-box important">
                    <div class="info-box-title">âš ï¸ Why Different Types?</div>
                    <p>Different membership function shapes work better for different types of data. The project implements all four to find the best match!</p>
                </div>

                <table>
                    <tr>
                        <th>Type</th>
                        <th>Shape</th>
                        <th>Best For</th>
                    </tr>
                    <tr>
                        <td>Triangular</td>
                        <td>Sharp peak (â–³)</td>
                        <td>Simple, interpretable categories</td>
                    </tr>
                    <tr>
                        <td>Trapezoidal</td>
                        <td>Flat top (â¡â€¾â€¾â¤)</td>
                        <td>Categories with a range of "full membership"</td>
                    </tr>
                    <tr>
                        <td>Gaussian</td>
                        <td>Bell curve (âˆ©)</td>
                        <td>Smooth, natural transitions</td>
                    </tr>
                    <tr>
                        <td>Bell</td>
                        <td>Adjustable bell</td>
                        <td>Fine-tunable transitions</td>
                    </tr>
                </table>

                <h3>2.4 Universe of Discourse</h3>
                <p>The <strong>Universe of Discourse</strong> is simply the range of all possible values. If your data ranges from 10 to 100, that's your universe.</p>
                
                <p>We add a small <strong>margin</strong> (typically 10%) to handle values slightly outside the training data:</p>
                <div class="formula">
                    U = [D<sub>min</sub> - 0.1 Ã— range, D<sub>max</sub> + 0.1 Ã— range]
                </div>

                <h3>2.5 Partitioning the Universe</h3>
                <p>We divide the universe into several overlapping fuzzy sets:</p>
                
                <div class="diagram">
Universe of Discourse: [0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 100]

With 5 partitions (A1 to A5):

Î¼(x)
1.0 â”‚    A1      A2      A3      A4      A5
    â”‚   â•±â•²      â•±â•²      â•±â•²      â•±â•²      â•±â•²
0.5 â”‚  â•±â”€â”€â•²â”€â”€â”€â”€â•±â”€â”€â•²â”€â”€â”€â”€â•±â”€â”€â•²â”€â”€â”€â”€â•±â”€â”€â•²â”€â”€â”€â”€â•±â”€â”€â•²
    â”‚ â•±    â•²  â•±    â•²  â•±    â•²  â•±    â•²  â•±    â•²
0.0 â”‚â•±â”€â”€â”€â”€â”€â”€â•²â•±â”€â”€â”€â”€â”€â”€â•²â•±â”€â”€â”€â”€â”€â”€â•²â•±â”€â”€â”€â”€â”€â”€â•²â•±â”€â”€â”€â”€â”€â”€â•²
    0     25     50     75     100
    
Notice how adjacent sets overlap at 0.5!
This ensures every value has meaningful membership.
                </div>

                <h3>2.6 Fuzzy Logical Relations (FLR)</h3>
                <p>An <strong>FLR</strong> describes a pattern: "If the current state is X, the next state is Y".</p>
                
                <div class="info-box success">
                    <div class="info-box-title">ğŸ“Œ Example</div>
                    <p>If today's data point fuzzifies to A3, and tomorrow's fuzzifies to A4, we create:</p>
                    <p style="text-align: center; font-size: 1.2rem;"><code>A3 â†’ A4</code></p>
                    <p>This means "Medium tends to be followed by Medium-High"</p>
                </div>

                <h3>2.7 Fuzzy Logical Relation Groups (FLRG)</h3>
                <p>We <strong>group</strong> all FLRs with the same left side (antecedent):</p>
                
                <div class="diagram">
Individual FLRs:          Grouped FLRG:
    A3 â†’ A4               A3 â†’ A2, A3, A4
    A3 â†’ A3               (All possible next states
    A3 â†’ A2                when current state is A3)
    A3 â†’ A4
                </div>

                <h3>2.8 First-Order vs High-Order FTS</h3>
                
                <table>
                    <tr>
                        <th>Type</th>
                        <th>Uses</th>
                        <th>Pattern</th>
                    </tr>
                    <tr>
                        <td>First-Order (FOFTS)</td>
                        <td>1 previous value</td>
                        <td>F(t) â†’ F(t+1)</td>
                    </tr>
                    <tr>
                        <td>High-Order (HOFTS)</td>
                        <td>k previous values</td>
                        <td>(F(t-k+1), ..., F(t)) â†’ F(t+1)</td>
                    </tr>
                </table>

                <div class="info-box concept">
                    <div class="info-box-title">ğŸ’¡ Why High-Order?</div>
                    <p>High-order models capture more complex patterns. Instead of just "what happened yesterday", they consider "what happened over the last k days".</p>
                    <p><strong>Trade-off:</strong> More context = potentially better predictions, but also more complexity and risk of overfitting.</p>
                </div>

                <div class="diagram">
FIRST-ORDER (k=1):
  Uses: [t-1]
  Pattern: A3 â†’ A4
  "If yesterday was Medium, tomorrow is Medium-High"

HIGH-ORDER (k=3):
  Uses: [t-3, t-2, t-1]
  Pattern: (A2, A3, A3) â†’ A4
  "If three days ago was Low, two days ago was Medium, 
   yesterday was Medium, tomorrow is Medium-High"
                </div>
            </section>

            <!-- ==================== SECTION 3: ALGORITHM ==================== -->
            <section id="algorithm">
                <h2>âš™ï¸ 3. The FTS Algorithm Step-by-Step</h2>

                <h3>3.1 Algorithm Overview</h3>
                <p>The FTS algorithm has two main phases: <strong>Training</strong> and <strong>Prediction</strong>.</p>

                <div class="diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TRAINING PHASE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Define Universe of Discourse                            â”‚
â”‚       â†“                                                     â”‚
â”‚  2. Create Fuzzy Set Partitions                             â”‚
â”‚       â†“                                                     â”‚
â”‚  3. Fuzzify Training Data                                   â”‚
â”‚       â†“                                                     â”‚
â”‚  4. Generate Fuzzy Logical Relations (FLRs)                 â”‚
â”‚       â†“                                                     â”‚
â”‚  5. Group into FLRGs                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PREDICTION PHASE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Fuzzify Input Values                                    â”‚
â”‚       â†“                                                     â”‚
â”‚  2. Look Up Matching FLRG                                   â”‚
â”‚       â†“                                                     â”‚
â”‚  3. Defuzzify to Get Crisp Output                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </div>

                <h3>3.2 Detailed Steps with Pseudocode</h3>

                <h4>Step 1: Define Universe of Discourse</h4>
                <pre><code>FUNCTION define_universe(data):
    D_min = MINIMUM(data)
    D_max = MAXIMUM(data)
    range = D_max - D_min
    margin = range Ã— 0.1
    
    RETURN Universe(
        lower_bound = D_min - margin,
        upper_bound = D_max + margin
    )
END FUNCTION</code></pre>

                <h4>Step 2: Create Fuzzy Set Partitions</h4>
                <pre><code>FUNCTION create_partitions(universe, num_partitions, mf_type):
    fuzzy_sets = empty list
    width = universe.range / (num_partitions - 1)
    
    FOR i FROM 0 TO num_partitions - 1:
        center = universe.lower_bound + (i Ã— width)
        
        IF mf_type == TRIANGULAR:
            left = center - width
            right = center + width
            CREATE TriangularFuzzySet(name="A{i+1}", a=left, b=center, c=right)
        ELSE IF mf_type == GAUSSIAN:
            sigma = width / 2.35  # For 0.5 crossover
            CREATE GaussianFuzzySet(name="A{i+1}", center=center, sigma=sigma)
        # ... other types
        
        ADD to fuzzy_sets
    END FOR
    
    RETURN fuzzy_sets
END FUNCTION</code></pre>

                <h4>Step 3: Fuzzify Data</h4>
                <pre><code>FUNCTION fuzzify(value, fuzzy_sets):
    max_membership = 0
    best_set = None
    
    FOR each fuzzy_set IN fuzzy_sets:
        membership = fuzzy_set.membership(value)
        IF membership > max_membership:
            max_membership = membership
            best_set = fuzzy_set.name
    END FOR
    
    RETURN best_set
END FUNCTION

FUNCTION fuzzify_series(data, fuzzy_sets):
    fuzzified = empty list
    FOR each value IN data:
        fuzzified.APPEND(fuzzify(value, fuzzy_sets))
    END FOR
    RETURN fuzzified
END FUNCTION</code></pre>

                <h4>Step 4: Generate FLRs</h4>
                <pre><code>FUNCTION generate_flrs(fuzzified_series, order):
    flrs = empty list
    
    FOR t FROM order TO LENGTH(fuzzified_series) - 1:
        # Get antecedent (previous 'order' values)
        antecedent = fuzzified_series[t - order : t]
        
        # Get consequent (current value)
        consequent = fuzzified_series[t]
        
        CREATE FLR(antecedent â†’ consequent)
        ADD to flrs
    END FOR
    
    RETURN flrs
END FUNCTION</code></pre>

                <h4>Step 5: Group into FLRGs</h4>
                <pre><code>FUNCTION group_flrs(flrs):
    flrgs = empty dictionary
    
    FOR each flr IN flrs:
        key = flr.antecedent
        IF key NOT IN flrgs:
            flrgs[key] = new FLRG(antecedent=key)
        END IF
        flrgs[key].add_consequent(flr.consequent)
    END FOR
    
    RETURN flrgs
END FUNCTION</code></pre>

                <h4>Step 6: Predict</h4>
                <pre><code>FUNCTION predict(history, fuzzy_sets, flrgs, order):
    # Step 1: Fuzzify the last 'order' values
    recent = history[LAST order values]
    fuzzified = empty tuple
    FOR each value IN recent:
        fuzzified.APPEND(fuzzify(value, fuzzy_sets))
    END FOR
    
    # Step 2: Look up matching FLRG
    IF fuzzified IN flrgs:
        consequents = flrgs[fuzzified].consequents
    ELSE:
        consequents = find_nearest_flrg(fuzzified, flrgs)
    END IF
    
    # Step 3: Defuzzify
    centers = empty list
    FOR each consequent IN consequents:
        centers.APPEND(get_center(consequent, fuzzy_sets))
    END FOR
    
    RETURN AVERAGE(centers)
END FUNCTION</code></pre>

                <h3>3.3 A Complete Worked Example</h3>
                
                <div class="info-box success">
                    <div class="info-box-title">ğŸ“ Let's Work Through an Example</div>
                </div>

                <p><strong>Given Data:</strong> [10, 15, 20, 18, 25, 30, 28]</p>
                <p><strong>Settings:</strong> Order = 1, Partitions = 5, MF = Triangular</p>

                <h4>Step 1: Universe of Discourse</h4>
                <pre><code>D_min = 10, D_max = 30
range = 30 - 10 = 20
margin = 20 Ã— 0.1 = 2
Universe = [10 - 2, 30 + 2] = [8, 32]</code></pre>

                <h4>Step 2: Create 5 Fuzzy Sets</h4>
                <div class="diagram">
Width = (32 - 8) / (5 - 1) = 6

Centers: 8, 14, 20, 26, 32

Fuzzy Sets:
  A1: center=8,  range=[2, 14]
  A2: center=14, range=[8, 20]
  A3: center=20, range=[14, 26]
  A4: center=26, range=[20, 32]
  A5: center=32, range=[26, 38]
                </div>

                <h4>Step 3: Fuzzify Each Value</h4>
                <table>
                    <tr>
                        <th>Value</th>
                        <th>Closest Center</th>
                        <th>Fuzzified As</th>
                    </tr>
                    <tr><td>10</td><td>8</td><td>A1</td></tr>
                    <tr><td>15</td><td>14</td><td>A2</td></tr>
                    <tr><td>20</td><td>20</td><td>A3</td></tr>
                    <tr><td>18</td><td>20</td><td>A3</td></tr>
                    <tr><td>25</td><td>26</td><td>A4</td></tr>
                    <tr><td>30</td><td>32</td><td>A5</td></tr>
                    <tr><td>28</td><td>26</td><td>A4</td></tr>
                </table>
                <p><strong>Fuzzified Series:</strong> [A1, A2, A3, A3, A4, A5, A4]</p>

                <h4>Step 4: Generate FLRs (Order=1)</h4>
                <pre><code>A1 â†’ A2
A2 â†’ A3
A3 â†’ A3
A3 â†’ A4
A4 â†’ A5
A5 â†’ A4</code></pre>

                <h4>Step 5: Group into FLRGs</h4>
                <pre><code>A1 â†’ A2
A2 â†’ A3
A3 â†’ A3, A4  (grouped two A3â†’ rules)
A4 â†’ A5
A5 â†’ A4</code></pre>

                <h4>Step 6: Predict Next Value</h4>
                <p>Current fuzzified state is A4 (from value 28).</p>
                <p>Look up FLRG: A4 â†’ A5</p>
                <p>Defuzzify: center of A5 = 32</p>
                <p><strong>Prediction: 32</strong></p>
            </section>

            <!-- ==================== SECTION 4: IMPLEMENTATION ==================== -->
            <section id="implementation">
                <h2>ğŸ’» 4. Python Implementation Details</h2>

                <div class="info-box warning">
                    <div class="info-box-title">âš ï¸ Important Note</div>
                    <p>This project was implemented <strong>entirely from scratch</strong> in Python, without using any pre-built FTS libraries. This was a requirement of the academic project.</p>
                </div>

                <h3>4.1 What Libraries Are Used and Why?</h3>
                
                <table>
                    <tr>
                        <th>Library</th>
                        <th>Purpose</th>
                        <th>Why It's Needed</th>
                    </tr>
                    <tr>
                        <td><code>numpy</code></td>
                        <td>Numerical operations</td>
                        <td>Fast array operations, mathematical functions (exp, sqrt, mean)</td>
                    </tr>
                    <tr>
                        <td><code>pandas</code></td>
                        <td>Data handling</td>
                        <td>Reading CSV/Excel files, data manipulation</td>
                    </tr>
                    <tr>
                        <td><code>matplotlib</code></td>
                        <td>Visualization</td>
                        <td>Creating plots and charts</td>
                    </tr>
                    <tr>
                        <td><code>openpyxl</code></td>
                        <td>Excel support</td>
                        <td>Reading .xlsx files (required by pandas)</td>
                    </tr>
                </table>

                <div class="info-box concept">
                    <div class="info-box-title">ğŸ’¡ About NumPy</div>
                    <p><strong>NumPy</strong> (Numerical Python) is the fundamental package for scientific computing in Python. It provides:</p>
                    <ul>
                        <li>Fast array operations (much faster than Python lists)</li>
                        <li>Mathematical functions: <code>np.exp()</code>, <code>np.sqrt()</code>, <code>np.mean()</code></li>
                        <li>Array manipulation: slicing, reshaping, filtering</li>
                    </ul>
                    <p>In our FTS project, we use NumPy for calculating membership degrees, computing errors, and handling time series data efficiently.</p>
                </div>

                <h3>4.2 Key Code Explanations</h3>

                <h4>Triangular Membership Function</h4>
                <pre><code>def triangular_membership(self, x):
    """
    Calculates how much 'x' belongs to this triangular fuzzy set.
    
    Parameters:
        a: left point (where membership starts rising from 0)
        b: peak point (where membership = 1)
        c: right point (where membership falls back to 0)
    """
    a = self.parameters['a']  # Left point
    b = self.parameters['b']  # Peak point
    c = self.parameters['c']  # Right point
    
    if x <= a or x >= c:
        # Outside the triangle = no membership
        return 0.0
    elif a < x <= b:
        # Rising slope: linearly increase from 0 to 1
        return (x - a) / (b - a)
    else:  # b < x < c
        # Falling slope: linearly decrease from 1 to 0
        return (c - x) / (c - b)</code></pre>

                <h4>Gaussian Membership Function</h4>
                <pre><code>def gaussian_membership(self, x):
    """
    Gaussian (bell curve) membership function.
    
    Formula: Î¼(x) = exp(-((x - c)Â² / (2ÏƒÂ²)))
    
    Parameters:
        c: center of the bell curve
        sigma: standard deviation (controls width)
    
    The result is always between 0 and 1:
        - At x = c: Î¼ = 1 (maximum membership)
        - As x moves away from c: Î¼ decreases smoothly
    """
    c = self.parameters['c']
    sigma = self.parameters['sigma']
    
    # NumPy's exp() calculates e^x efficiently
    return np.exp(-((x - c) ** 2) / (2 * sigma ** 2))</code></pre>

                <h4>Finding the Best Fuzzy Set (Fuzzification)</h4>
                <pre><code>def fuzzify_value(self, value):
    """
    Convert a crisp number to a fuzzy set name.
    
    Process:
    1. Calculate membership degree in ALL fuzzy sets
    2. Return the name of the set with HIGHEST membership
    
    This is called "maximum membership" fuzzification.
    """
    max_membership = -1  # Start with impossible value
    best_set_name = None
    
    for fuzzy_set in self.fuzzy_sets:
        # Calculate how much 'value' belongs to this set
        membership = fuzzy_set.membership(value)
        
        if membership > max_membership:
            max_membership = membership
            best_set_name = fuzzy_set.name
    
    return best_set_name</code></pre>

                <h4>Defuzzification (Getting a Crisp Prediction)</h4>
                <pre><code>def defuzzify(self, fuzzy_set_names):
    """
    Convert fuzzy set names back to a crisp number.
    
    Method: Centroid (average of centers)
    
    If FLRG A3 â†’ A2, A4, A5:
        Centers: A2=14, A4=26, A5=32
        Prediction = (14 + 26 + 32) / 3 = 24
    """
    if not fuzzy_set_names:
        # No consequents? Return middle of universe
        return (self.universe.lower_bound + self.universe.upper_bound) / 2
    
    # Get the center value of each consequent fuzzy set
    centers = []
    for name in fuzzy_set_names:
        fuzzy_set = self.fuzzy_set_map[name]
        centers.append(fuzzy_set.center)
    
    # Return the average
    return np.mean(centers)</code></pre>

                <h3>4.3 Error Metrics Explained</h3>
                
                <table>
                    <tr>
                        <th>Metric</th>
                        <th>Formula</th>
                        <th>What It Tells You</th>
                    </tr>
                    <tr>
                        <td>RMSE</td>
                        <td>âˆš(mean((actual - predicted)Â²))</td>
                        <td>Average error magnitude, penalizes large errors more</td>
                    </tr>
                    <tr>
                        <td>MAE</td>
                        <td>mean(|actual - predicted|)</td>
                        <td>Average absolute error, more intuitive</td>
                    </tr>
                    <tr>
                        <td>MAPE</td>
                        <td>mean(|actual - predicted| / |actual|) Ã— 100%</td>
                        <td>Percentage error, scale-independent</td>
                    </tr>
                </table>

                <pre><code>@staticmethod
def rmse(actual, predicted):
    """
    Root Mean Square Error
    
    Steps:
    1. Calculate error for each point: (actual - predicted)
    2. Square each error: (error)Â²
    3. Take the mean of all squared errors
    4. Take the square root
    
    Lower RMSE = Better predictions
    """
    # Remove any NaN values first
    mask = ~np.isnan(predicted) & ~np.isnan(actual)
    actual_clean = actual[mask]
    predicted_clean = predicted[mask]
    
    # Calculate: sqrt(mean((actual - predicted)Â²))
    squared_errors = (actual_clean - predicted_clean) ** 2
    mean_squared_error = np.mean(squared_errors)
    return np.sqrt(mean_squared_error)</code></pre>
            </section>

            <!-- ==================== SECTION 5: FILE STRUCTURE ==================== -->
            <section id="files">
                <h2>ğŸ“ 5. Project Files Explained</h2>

                <div class="info-box important">
                    <div class="info-box-title">ğŸ“Œ Do You Need Auxiliary Files?</div>
                    <p>The project has several Python files. Here's what each one does and whether you need to modify it.</p>
                </div>

                <!-- File: fts_core.py -->
                <div class="file-card">
                    <div class="file-card-header" onclick="toggleFile(this)">
                        <span class="file-icon">ğŸ</span>
                        <span class="file-name">fts_core.py</span>
                        <span style="margin-left: auto; color: var(--accent-secondary);">ESSENTIAL â–¼</span>
                    </div>
                    <div class="file-card-content">
                        <h4>What Does This File Do?</h4>
                        <p>This is the <strong>heart of the project</strong>. It contains all the core FTS algorithms:</p>
                        <ul>
                            <li><code>FuzzySet</code> class: Defines a single fuzzy set with its membership function</li>
                            <li><code>UniverseOfDiscourse</code>: Defines the range of possible values</li>
                            <li><code>FuzzySetPartitioner</code>: Creates evenly-spaced fuzzy sets</li>
                            <li><code>FuzzyTimeSeries</code>: The main class that trains and predicts</li>
                            <li><code>FTSMetrics</code>: Calculates RMSE, MAE, MAPE</li>
                        </ul>
                        
                        <h4>Do You Need to Modify It?</h4>
                        <p>Only if you want to:</p>
                        <ul>
                            <li>Add a new type of membership function</li>
                            <li>Change how fuzzification works</li>
                            <li>Implement a different defuzzification method</li>
                        </ul>
                        
                        <h4>Key Classes Summary</h4>
                        <pre><code># MembershipFunctionType: Enum defining the 4 MF types
class MembershipFunctionType(Enum):
    TRIANGULAR = "triangular"
    TRAPEZOIDAL = "trapezoidal"
    GAUSSIAN = "gaussian"
    BELL = "bell"

# FuzzySet: Represents one fuzzy set (e.g., "A3")
class FuzzySet:
    name: str          # e.g., "A3"
    mf_type: MembershipFunctionType
    parameters: dict   # e.g., {'a': 10, 'b': 20, 'c': 30}
    center: float      # e.g., 20

# FuzzyTimeSeries: Main class for training and prediction
class FuzzyTimeSeries:
    def fit(self, data):      # Train the model
    def predict_next(self, history):  # Predict next value
    def forecast(self, steps):  # Predict multiple steps</code></pre>
                    </div>
                </div>

                <!-- File: fts_data.py -->
                <div class="file-card">
                    <div class="file-card-header" onclick="toggleFile(this)">
                        <span class="file-icon">ğŸ</span>
                        <span class="file-name">fts_data.py</span>
                        <span style="margin-left: auto; color: var(--accent-primary);">HELPER â–¼</span>
                    </div>
                    <div class="file-card-content">
                        <h4>What Does This File Do?</h4>
                        <p>Handles <strong>loading and preprocessing data</strong>:</p>
                        <ul>
                            <li><code>DataLoader.load_mackey_glass()</code>: Reads the Mackey-Glass CSV file</li>
                            <li><code>DataLoader.load_influenza_data()</code>: Reads the Influenza Excel file</li>
                            <li>Preprocessing utilities: normalize, remove NaN, smoothing</li>
                        </ul>
                        
                        <h4>Do You Need to Modify It?</h4>
                        <p>Only if you want to:</p>
                        <ul>
                            <li>Load a different dataset format</li>
                            <li>Add new preprocessing steps</li>
                        </ul>
                        
                        <h4>Example Usage</h4>
                        <pre><code>from fts_data import DataLoader

# Load Mackey-Glass data
data = DataLoader.load_mackey_glass('mackey_glass.csv')
# Returns: numpy array of values

# Load Influenza data
inf_data = DataLoader.load_influenza_data('Specimens-Train.xlsx')
# Returns: dict with 'total_specimens', 'influenza_a', 'influenza_b'</code></pre>
                    </div>
                </div>

                <!-- File: fts_visualization.py -->
                <div class="file-card">
                    <div class="file-card-header" onclick="toggleFile(this)">
                        <span class="file-icon">ğŸ</span>
                        <span class="file-name">fts_visualization.py</span>
                        <span style="margin-left: auto; color: var(--accent-primary);">HELPER â–¼</span>
                    </div>
                    <div class="file-card-content">
                        <h4>What Does This File Do?</h4>
                        <p>Creates all the <strong>charts and plots</strong>:</p>
                        <ul>
                            <li>Membership function plots</li>
                            <li>Actual vs Predicted time series</li>
                            <li>Error metric heatmaps</li>
                            <li>Fuzzification visualization</li>
                        </ul>
                        
                        <h4>Do You Need to Modify It?</h4>
                        <p>Only if you want to customize the appearance of plots.</p>
                        
                        <h4>Uses Matplotlib</h4>
                        <p>This file uses <code>matplotlib</code>, Python's standard plotting library. It's like Excel charts but for Python.</p>
                    </div>
                </div>

                <!-- File: fts_experiments.py -->
                <div class="file-card">
                    <div class="file-card-header" onclick="toggleFile(this)">
                        <span class="file-icon">ğŸ</span>
                        <span class="file-name">fts_experiments.py</span>
                        <span style="margin-left: auto; color: var(--accent-primary);">HELPER â–¼</span>
                    </div>
                    <div class="file-card-content">
                        <h4>What Does This File Do?</h4>
                        <p>Runs <strong>systematic experiments</strong> to find the best model configuration:</p>
                        <ul>
                            <li><code>ExperimentRunner</code>: Runs experiments on one dataset</li>
                            <li><code>run_grid_search()</code>: Tests all combinations of parameters</li>
                            <li><code>compare_orders()</code>: Compares First-Order vs High-Order</li>
                        </ul>
                        
                        <h4>What is a Grid Search?</h4>
                        <p>Testing every combination of parameters systematically:</p>
                        <pre><code>Orders:     [1, 2, 3, 4, 5]
Partitions: [5, 7, 9, 11, 13, 15, 17]
MF Types:   [triangular, trapezoidal, gaussian, bell]

Total combinations: 5 Ã— 7 Ã— 4 = 140 experiments</code></pre>
                    </div>
                </div>

                <!-- File: fts_interface.py -->
                <div class="file-card">
                    <div class="file-card-header" onclick="toggleFile(this)">
                        <span class="file-icon">ğŸ</span>
                        <span class="file-name">fts_interface.py</span>
                        <span style="margin-left: auto; color: var(--text-muted);">OPTIONAL â–¼</span>
                    </div>
                    <div class="file-card-content">
                        <h4>What Does This File Do?</h4>
                        <p>Provides an <strong>interactive command-line interface</strong> for making predictions:</p>
                        <ul>
                            <li>Type values and get predictions</li>
                            <li>View the FLRGs</li>
                            <li>Multi-step forecasting</li>
                        </ul>
                        
                        <h4>Do You Need It?</h4>
                        <p><strong>No, it's optional.</strong> It's just a convenience tool for testing the model interactively.</p>
                    </div>
                </div>

                <!-- File: fts_report.py -->
                <div class="file-card">
                    <div class="file-card-header" onclick="toggleFile(this)">
                        <span class="file-icon">ğŸ</span>
                        <span class="file-name">fts_report.py</span>
                        <span style="margin-left: auto; color: var(--text-muted);">OPTIONAL â–¼</span>
                    </div>
                    <div class="file-card-content">
                        <h4>What Does This File Do?</h4>
                        <p>Generates <strong>text reports and appendices</strong>:</p>
                        <ul>
                            <li>FLRG listings</li>
                            <li>Fuzzy set definitions</li>
                            <li>Comprehensive analysis reports</li>
                        </ul>
                        
                        <h4>Do You Need It?</h4>
                        <p><strong>Only for generating documentation.</strong> Not needed for the core FTS functionality.</p>
                    </div>
                </div>

                <!-- File: main.py -->
                <div class="file-card">
                    <div class="file-card-header" onclick="toggleFile(this)">
                        <span class="file-icon">ğŸ</span>
                        <span class="file-name">main.py</span>
                        <span style="margin-left: auto; color: var(--accent-secondary);">RUN THIS â–¼</span>
                    </div>
                    <div class="file-card-content">
                        <h4>What Does This File Do?</h4>
                        <p>This is the <strong>entry point</strong> - the file you run to execute all experiments:</p>
                        <ul>
                            <li>Loads all datasets</li>
                            <li>Runs grid search on each dataset</li>
                            <li>Generates all visualizations</li>
                            <li>Produces the final summary</li>
                        </ul>
                        
                        <h4>How to Run</h4>
                        <pre><code>python main.py</code></pre>
                        <p>This will run for a few minutes and produce all results in the <code>results/</code> folder.</p>
                    </div>
                </div>

                <!-- File: run_interactive.py -->
                <div class="file-card">
                    <div class="file-card-header" onclick="toggleFile(this)">
                        <span class="file-icon">ğŸ</span>
                        <span class="file-name">run_interactive.py</span>
                        <span style="margin-left: auto; color: var(--text-muted);">OPTIONAL â–¼</span>
                    </div>
                    <div class="file-card-content">
                        <h4>What Does This File Do?</h4>
                        <p>A standalone script for <strong>interactive testing</strong>:</p>
                        <pre><code>python run_interactive.py --dataset mackey_glass --order 3</code></pre>
                        
                        <h4>Do You Need It?</h4>
                        <p><strong>No.</strong> It's just for experimenting with the model manually.</p>
                    </div>
                </div>

                <h3>5.1 File Dependency Diagram</h3>
                <div class="diagram">
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚   main.py     â”‚ â† RUN THIS
                           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                         â”‚                         â”‚
         â–¼                         â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   fts_core.py   â”‚    â”‚   fts_data.py   â”‚    â”‚fts_experiments  â”‚
â”‚   (ESSENTIAL)   â”‚    â”‚    (HELPER)     â”‚    â”‚     (HELPER)    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ FuzzySet      â”‚    â”‚ â€¢ DataLoader    â”‚    â”‚ â€¢ GridSearch    â”‚
â”‚ â€¢ FTS Model     â”‚    â”‚ â€¢ Preprocessing â”‚    â”‚ â€¢ Comparisons   â”‚
â”‚ â€¢ Metrics       â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                            â”‚
         â”‚                                            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚                     â”‚
         â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚fts_visualizationâ”‚  â”‚  fts_report.py  â”‚  â”‚ fts_interface   â”‚
â”‚   (HELPER)      â”‚  â”‚   (OPTIONAL)    â”‚  â”‚   (OPTIONAL)    â”‚
â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚
â”‚ â€¢ Plots         â”‚  â”‚ â€¢ Text reports  â”‚  â”‚ â€¢ Interactive   â”‚
â”‚ â€¢ Charts        â”‚  â”‚ â€¢ Appendices    â”‚  â”‚   CLI           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </div>
            </section>

            <!-- ==================== SECTION 6: INTERACTIVE DEMO ==================== -->
            <section id="demo">
                <h2>ğŸ® 6. Interactive Demonstration</h2>

                <p>Try out the FTS algorithm yourself! Enter values and see how fuzzification and prediction work.</p>

                <div class="interactive-demo">
                    <h4>ğŸ§ª Fuzzification Demo</h4>
                    <p>Enter a value to see which fuzzy set it belongs to:</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <label for="demo-min">Universe Min:</label>
                            <input type="number" id="demo-min" value="0" step="any">
                        </div>
                        <div>
                            <label for="demo-max">Universe Max:</label>
                            <input type="number" id="demo-max" value="100" step="any">
                        </div>
                        <div>
                            <label for="demo-partitions">Number of Partitions:</label>
                            <input type="number" id="demo-partitions" value="5" min="3" max="15">
                        </div>
                        <div>
                            <label for="demo-value">Value to Fuzzify:</label>
                            <input type="number" id="demo-value" value="45" step="any">
                        </div>
                    </div>
                    
                    <button onclick="runFuzzificationDemo()">Fuzzify Value</button>
                    
                    <div id="fuzzification-result" style="margin-top: 20px;"></div>
                </div>

                <div class="interactive-demo">
                    <h4>ğŸ“Š Membership Function Visualization</h4>
                    <div class="canvas-container">
                        <canvas id="mf-canvas" width="700" height="300"></canvas>
                    </div>
                    <button onclick="drawMembershipFunctions()">Redraw</button>
                </div>

                <div class="interactive-demo">
                    <h4>ğŸ”® Simple FTS Prediction Demo</h4>
                    <p>Enter a comma-separated time series to see FTS in action:</p>
                    
                    <label for="demo-series">Time Series (comma-separated):</label>
                    <input type="text" id="demo-series" value="10, 15, 20, 18, 25, 30, 28, 35, 32">
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
                        <div>
                            <label for="demo-order">FTS Order:</label>
                            <input type="number" id="demo-order" value="1" min="1" max="5">
                        </div>
                        <div>
                            <label for="demo-parts">Partitions:</label>
                            <input type="number" id="demo-parts" value="5" min="3" max="15">
                        </div>
                    </div>
                    
                    <button onclick="runFTSDemo()">Run FTS Analysis</button>
                    
                    <div id="fts-result" style="margin-top: 20px;"></div>
                </div>
            </section>

            <!-- ==================== SECTION 7: RESULTS ==================== -->
            <section id="results">
                <h2>ğŸ“Š 7. Project Results Summary</h2>

                <h3>7.1 Best Configurations Found</h3>
                <table>
                    <tr>
                        <th>Dataset</th>
                        <th>Best Order</th>
                        <th>Partitions</th>
                        <th>MF Type</th>
                        <th>Test RMSE</th>
                        <th>Test MAPE</th>
                    </tr>
                    <tr>
                        <td>Mackey-Glass</td>
                        <td>4 (HOFTS)</td>
                        <td>17</td>
                        <td>Trapezoidal</td>
                        <td>0.047</td>
                        <td>6.20%</td>
                    </tr>
                    <tr>
                        <td>Total Specimens</td>
                        <td>1 (FOFTS)</td>
                        <td>9</td>
                        <td>Triangular</td>
                        <td>9,285</td>
                        <td>11.16%</td>
                    </tr>
                    <tr>
                        <td>Influenza A</td>
                        <td>2 (HOFTS)</td>
                        <td>9</td>
                        <td>Trapezoidal</td>
                        <td>2,976</td>
                        <td>299.65%</td>
                    </tr>
                    <tr>
                        <td>Influenza B</td>
                        <td>1 (FOFTS)</td>
                        <td>11</td>
                        <td>Trapezoidal</td>
                        <td>371</td>
                        <td>101.36%</td>
                    </tr>
                </table>

                <h3>7.2 Key Findings</h3>
                
                <div class="info-box success">
                    <div class="info-box-title">âœ… What We Learned</div>
                    <ul>
                        <li><strong>Mackey-Glass:</strong> Higher-order (4) with more partitions (17) works best for this smooth, chaotic dataset</li>
                        <li><strong>Influenza Data:</strong> Simpler models (order 1-2) work better for the more irregular real-world data</li>
                        <li><strong>Trapezoidal MFs:</strong> Often outperform other types, likely due to their broader "full membership" region</li>
                        <li><strong>High MAPE for Influenza:</strong> Due to many small values (near zero), percentage errors become inflated</li>
                    </ul>
                </div>

                <h3>7.3 Order Comparison Analysis</h3>
                
                <p>For the Mackey-Glass dataset, we can see how performance changes with order:</p>
                
                <table>
                    <tr>
                        <th>Order</th>
                        <th>Type</th>
                        <th>Test RMSE</th>
                        <th>Observation</th>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>FOFTS</td>
                        <td>0.061</td>
                        <td>Baseline</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>HOFTS</td>
                        <td>0.057</td>
                        <td>7% improvement</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>HOFTS</td>
                        <td>0.050</td>
                        <td>12% improvement</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>HOFTS</td>
                        <td>0.047</td>
                        <td>Best! 23% improvement</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>HOFTS</td>
                        <td>0.056</td>
                        <td>Overfitting begins</td>
                    </tr>
                </table>

                <div class="info-box important">
                    <div class="info-box-title">âš ï¸ The Overfitting Trade-off</div>
                    <p>Notice how order 5 performs <em>worse</em> than order 4. This is <strong>overfitting</strong>: the model becomes too specific to training patterns and loses generalization ability.</p>
                </div>
            </section>
        </div>

        <!-- ==================== SIDEBAR: PROGRESS TRACKER ==================== -->
        <aside class="sidebar">
            <div class="progress-tracker">
                <h3>ğŸ“‹ Learning Progress</h3>
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="progress-fill" style="width: 0%;"></div>
                </div>
                <div class="progress-text" id="progress-text">0 of 15 completed</div>
                
                <ul class="checklist" id="checklist">
                    <li data-step="1">
                        <input type="checkbox" id="step1">
                        <label for="step1">Understand what FTS is</label>
                    </li>
                    <li data-step="2">
                        <input type="checkbox" id="step2">
                        <label for="step2">Learn about fuzzy sets</label>
                    </li>
                    <li data-step="3">
                        <input type="checkbox" id="step3">
                        <label for="step3">Understand membership functions</label>
                    </li>
                    <li data-step="4">
                        <input type="checkbox" id="step4">
                        <label for="step4">Learn the 4 MF types</label>
                    </li>
                    <li data-step="5">
                        <input type="checkbox" id="step5">
                        <label for="step5">Understand Universe of Discourse</label>
                    </li>
                    <li data-step="6">
                        <input type="checkbox" id="step6">
                        <label for="step6">Learn about partitioning</label>
                    </li>
                    <li data-step="7">
                        <input type="checkbox" id="step7">
                        <label for="step7">Understand FLRs</label>
                    </li>
                    <li data-step="8">
                        <input type="checkbox" id="step8">
                        <label for="step8">Understand FLRGs</label>
                    </li>
                    <li data-step="9">
                        <input type="checkbox" id="step9">
                        <label for="step9">First-Order vs High-Order</label>
                    </li>
                    <li data-step="10">
                        <input type="checkbox" id="step10">
                        <label for="step10">Review the algorithm steps</label>
                    </li>
                    <li data-step="11">
                        <input type="checkbox" id="step11">
                        <label for="step11">Work through the example</label>
                    </li>
                    <li data-step="12">
                        <input type="checkbox" id="step12">
                        <label for="step12">Understand Python libraries</label>
                    </li>
                    <li data-step="13">
                        <input type="checkbox" id="step13">
                        <label for="step13">Review file structure</label>
                    </li>
                    <li data-step="14">
                        <input type="checkbox" id="step14">
                        <label for="step14">Try the interactive demo</label>
                    </li>
                    <li data-step="15">
                        <input type="checkbox" id="step15">
                        <label for="step15">Review results</label>
                    </li>
                </ul>
                
                <button onclick="resetProgress()" class="secondary" style="width: 100%; margin-top: 15px;">
                    Reset Progress
                </button>
            </div>
        </aside>
    </main>

    <!-- ============================================
         FOOTER
         ============================================ -->
    <footer>
        <p>Fuzzy Time Series Forecasting - Educational Guide</p>
        <p style="font-size: 0.9rem; margin-top: 10px;">
            Built for learning. All concepts explained step-by-step.
        </p>
    </footer>

    <!-- ============================================
         JAVASCRIPT
         ============================================
         
         This script handles:
         1. Progress tracking with localStorage
         2. Interactive demonstrations
         3. Navigation highlighting
         4. File card toggles
    -->
    <script>
        // ==========================================
        // PROGRESS TRACKING SYSTEM
        // ==========================================
        // 
        // WHY localStorage?
        // - Persists data even after browser is closed
        // - Simple key-value storage
        // - No server needed
        // - Works offline
        //
        // HOW IT WORKS:
        // 1. When checkbox is clicked, save state to localStorage
        // 2. When page loads, read from localStorage and restore state
        // 3. localStorage stores strings, so we JSON.stringify objects

        const STORAGE_KEY = 'fts_learning_progress';
        const TOTAL_STEPS = 15;

        // Load saved progress when page opens
        function loadProgress() {
            try {
                // Get saved data from localStorage
                const saved = localStorage.getItem(STORAGE_KEY);
                
                if (saved) {
                    // Parse the JSON string back to an object
                    const progress = JSON.parse(saved);
                    
                    // Restore each checkbox state
                    for (const [step, completed] of Object.entries(progress)) {
                        const checkbox = document.getElementById(`step${step}`);
                        if (checkbox) {
                            checkbox.checked = completed;
                            updateStepStyle(step, completed);
                        }
                    }
                }
                
                // Update the progress bar
                updateProgressBar();
            } catch (error) {
                console.error('Error loading progress:', error);
            }
        }

        // Save progress when checkbox changes
        function saveProgress() {
            try {
                const progress = {};
                
                // Collect state of all checkboxes
                for (let i = 1; i <= TOTAL_STEPS; i++) {
                    const checkbox = document.getElementById(`step${i}`);
                    if (checkbox) {
                        progress[i] = checkbox.checked;
                    }
                }
                
                // Convert to JSON string and save
                localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
                
                // Update progress bar
                updateProgressBar();
            } catch (error) {
                console.error('Error saving progress:', error);
            }
        }

        // Update visual style of a step
        function updateStepStyle(step, completed) {
            const li = document.querySelector(`li[data-step="${step}"]`);
            if (li) {
                if (completed) {
                    li.classList.add('completed');
                } else {
                    li.classList.remove('completed');
                }
            }
        }

        // Update the progress bar
        function updateProgressBar() {
            let completed = 0;
            
            for (let i = 1; i <= TOTAL_STEPS; i++) {
                const checkbox = document.getElementById(`step${i}`);
                if (checkbox && checkbox.checked) {
                    completed++;
                }
            }
            
            const percentage = (completed / TOTAL_STEPS) * 100;
            
            // Update progress bar width
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            
            // Update text
            document.getElementById('progress-text').textContent = 
                `${completed} of ${TOTAL_STEPS} completed`;
        }

        // Reset all progress
        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress?')) {
                localStorage.removeItem(STORAGE_KEY);
                
                // Uncheck all boxes
                for (let i = 1; i <= TOTAL_STEPS; i++) {
                    const checkbox = document.getElementById(`step${i}`);
                    if (checkbox) {
                        checkbox.checked = false;
                        updateStepStyle(i, false);
                    }
                }
                
                updateProgressBar();
            }
        }

        // Set up checkbox listeners
        function setupCheckboxListeners() {
            for (let i = 1; i <= TOTAL_STEPS; i++) {
                const checkbox = document.getElementById(`step${i}`);
                if (checkbox) {
                    checkbox.addEventListener('change', function() {
                        updateStepStyle(i, this.checked);
                        saveProgress();
                    });
                }
            }
        }

        // ==========================================
        // FILE CARD TOGGLE
        // ==========================================
        function toggleFile(header) {
            const content = header.nextElementSibling;
            const isExpanded = content.classList.contains('expanded');
            
            // Toggle expanded state
            if (isExpanded) {
                content.classList.remove('expanded');
                header.querySelector('span:last-child').textContent = 
                    header.querySelector('span:last-child').textContent.replace('â–²', 'â–¼');
            } else {
                content.classList.add('expanded');
                header.querySelector('span:last-child').textContent = 
                    header.querySelector('span:last-child').textContent.replace('â–¼', 'â–²');
            }
        }

        // ==========================================
        // NAVIGATION HIGHLIGHTING
        // ==========================================
        function setupNavigation() {
            const navLinks = document.querySelectorAll('nav a');
            const sections = document.querySelectorAll('section');
            
            // Scroll spy: highlight nav item when section is visible
            window.addEventListener('scroll', () => {
                let current = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.clientHeight;
                    
                    if (scrollY >= sectionTop - 200) {
                        current = section.getAttribute('id');
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${current}`) {
                        link.classList.add('active');
                    }
                });
            });
        }

        // ==========================================
        // INTERACTIVE DEMOS
        // ==========================================
        
        // Create triangular membership function
        function triangularMembership(x, a, b, c) {
            if (x <= a || x >= c) return 0;
            if (a < x && x <= b) return (x - a) / (b - a);
            if (b < x && x < c) return (c - x) / (c - b);
            return 0;
        }

        // Run fuzzification demo
        function runFuzzificationDemo() {
            const min = parseFloat(document.getElementById('demo-min').value);
            const max = parseFloat(document.getElementById('demo-max').value);
            const numPartitions = parseInt(document.getElementById('demo-partitions').value);
            const value = parseFloat(document.getElementById('demo-value').value);
            
            // Add margin
            const range = max - min;
            const margin = range * 0.1;
            const uMin = min - margin;
            const uMax = max + margin;
            
            // Create fuzzy sets
            const width = (uMax - uMin) / (numPartitions - 1);
            const fuzzySets = [];
            
            for (let i = 0; i < numPartitions; i++) {
                const center = uMin + i * width;
                fuzzySets.push({
                    name: `A${i + 1}`,
                    a: center - width,
                    b: center,
                    c: center + width,
                    center: center
                });
            }
            
            // Calculate memberships
            let maxMembership = 0;
            let bestSet = null;
            const memberships = [];
            
            fuzzySets.forEach(fs => {
                const membership = triangularMembership(value, fs.a, fs.b, fs.c);
                memberships.push({ name: fs.name, membership: membership.toFixed(4) });
                
                if (membership > maxMembership) {
                    maxMembership = membership;
                    bestSet = fs.name;
                }
            });
            
            // Display result
            let html = `
                <div class="info-box success">
                    <div class="info-box-title">Result</div>
                    <p><strong>Value ${value}</strong> fuzzifies to <strong>${bestSet}</strong></p>
                    <p>Maximum membership: ${maxMembership.toFixed(4)}</p>
                </div>
                <h4>All Memberships:</h4>
                <table>
                    <tr><th>Fuzzy Set</th><th>Membership Degree</th></tr>
                    ${memberships.map(m => `<tr><td>${m.name}</td><td>${m.membership}</td></tr>`).join('')}
                </table>
            `;
            
            document.getElementById('fuzzification-result').innerHTML = html;
            drawMembershipFunctions();
        }

        // Draw membership functions on canvas
        function drawMembershipFunctions() {
            const canvas = document.getElementById('mf-canvas');
            const ctx = canvas.getContext('2d');
            
            const min = parseFloat(document.getElementById('demo-min').value);
            const max = parseFloat(document.getElementById('demo-max').value);
            const numPartitions = parseInt(document.getElementById('demo-partitions').value);
            const value = parseFloat(document.getElementById('demo-value').value);
            
            // Clear canvas
            ctx.fillStyle = '#0d1117';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Add margin
            const range = max - min;
            const margin = range * 0.1;
            const uMin = min - margin;
            const uMax = max + margin;
            
            // Padding
            const padding = { left: 50, right: 30, top: 30, bottom: 40 };
            const plotWidth = canvas.width - padding.left - padding.right;
            const plotHeight = canvas.height - padding.top - padding.bottom;
            
            // Scale functions
            const xScale = (x) => padding.left + ((x - uMin) / (uMax - uMin)) * plotWidth;
            const yScale = (y) => padding.top + plotHeight - y * plotHeight;
            
            // Draw axes
            ctx.strokeStyle = '#30363d';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(padding.left, padding.top);
            ctx.lineTo(padding.left, canvas.height - padding.bottom);
            ctx.lineTo(canvas.width - padding.right, canvas.height - padding.bottom);
            ctx.stroke();
            
            // Draw axis labels
            ctx.fillStyle = '#8b949e';
            ctx.font = '12px sans-serif';
            ctx.textAlign = 'center';
            
            // X-axis labels
            for (let i = 0; i <= 5; i++) {
                const x = uMin + (i / 5) * (uMax - uMin);
                ctx.fillText(x.toFixed(1), xScale(x), canvas.height - padding.bottom + 20);
            }
            
            // Y-axis labels
            ctx.textAlign = 'right';
            ctx.fillText('1.0', padding.left - 10, yScale(1) + 4);
            ctx.fillText('0.5', padding.left - 10, yScale(0.5) + 4);
            ctx.fillText('0.0', padding.left - 10, yScale(0) + 4);
            
            // Colors for fuzzy sets
            const colors = [
                '#ff6b6b', '#feca57', '#48dbfb', '#ff9ff3', '#54a0ff',
                '#5f27cd', '#00d2d3', '#ff9f43', '#10ac84', '#ee5a24'
            ];
            
            // Create fuzzy sets
            const width = (uMax - uMin) / (numPartitions - 1);
            const fuzzySets = [];
            
            for (let i = 0; i < numPartitions; i++) {
                const center = uMin + i * width;
                fuzzySets.push({
                    name: `A${i + 1}`,
                    a: center - width,
                    b: center,
                    c: center + width
                });
            }
            
            // Draw each fuzzy set
            fuzzySets.forEach((fs, index) => {
                ctx.strokeStyle = colors[index % colors.length];
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                const step = (uMax - uMin) / 200;
                let started = false;
                
                for (let x = uMin; x <= uMax; x += step) {
                    const y = triangularMembership(x, fs.a, fs.b, fs.c);
                    if (!started) {
                        ctx.moveTo(xScale(x), yScale(y));
                        started = true;
                    } else {
                        ctx.lineTo(xScale(x), yScale(y));
                    }
                }
                
                ctx.stroke();
                
                // Label
                ctx.fillStyle = colors[index % colors.length];
                ctx.font = 'bold 11px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(fs.name, xScale(fs.b), yScale(1) - 5);
            });
            
            // Draw vertical line for input value
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(xScale(value), yScale(0));
            ctx.lineTo(xScale(value), yScale(1));
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Label the value
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 12px sans-serif';
            ctx.fillText(`x = ${value}`, xScale(value), yScale(0) + 15);
        }

        // Run FTS demo
        function runFTSDemo() {
            const seriesInput = document.getElementById('demo-series').value;
            const order = parseInt(document.getElementById('demo-order').value);
            const numPartitions = parseInt(document.getElementById('demo-parts').value);
            
            // Parse series
            const data = seriesInput.split(',').map(s => parseFloat(s.trim())).filter(n => !isNaN(n));
            
            if (data.length < order + 2) {
                document.getElementById('fts-result').innerHTML = 
                    '<div class="info-box warning"><div class="info-box-title">Error</div><p>Need at least ' + 
                    (order + 2) + ' data points for order ' + order + '</p></div>';
                return;
            }
            
            // Define universe
            const min = Math.min(...data);
            const max = Math.max(...data);
            const range = max - min;
            const margin = range * 0.1;
            const uMin = min - margin;
            const uMax = max + margin;
            
            // Create fuzzy sets
            const width = (uMax - uMin) / (numPartitions - 1);
            const fuzzySets = [];
            
            for (let i = 0; i < numPartitions; i++) {
                const center = uMin + i * width;
                fuzzySets.push({
                    name: `A${i + 1}`,
                    a: center - width,
                    b: center,
                    c: center + width,
                    center: center
                });
            }
            
            // Fuzzify function
            function fuzzify(value) {
                let maxMem = 0;
                let best = fuzzySets[0].name;
                
                fuzzySets.forEach(fs => {
                    const mem = triangularMembership(value, fs.a, fs.b, fs.c);
                    if (mem > maxMem) {
                        maxMem = mem;
                        best = fs.name;
                    }
                });
                
                return best;
            }
            
            // Fuzzify series
            const fuzzified = data.map(v => fuzzify(v));
            
            // Generate FLRs
            const flrs = [];
            for (let t = order; t < fuzzified.length; t++) {
                const antecedent = fuzzified.slice(t - order, t).join(', ');
                const consequent = fuzzified[t];
                flrs.push({ antecedent, consequent });
            }
            
            // Group into FLRGs
            const flrgs = {};
            flrs.forEach(flr => {
                if (!flrgs[flr.antecedent]) {
                    flrgs[flr.antecedent] = new Set();
                }
                flrgs[flr.antecedent].add(flr.consequent);
            });
            
            // Predict next value
            const lastAntecedent = fuzzified.slice(-order).join(', ');
            let prediction = 'Unknown';
            let predictedValue = 'N/A';
            
            if (flrgs[lastAntecedent]) {
                const consequents = Array.from(flrgs[lastAntecedent]);
                prediction = consequents.join(', ');
                
                // Defuzzify
                let centerSum = 0;
                consequents.forEach(c => {
                    const fs = fuzzySets.find(f => f.name === c);
                    if (fs) centerSum += fs.center;
                });
                predictedValue = (centerSum / consequents.length).toFixed(2);
            }
            
            // Display results
            let html = `
                <h4>Universe of Discourse</h4>
                <p>[${uMin.toFixed(2)}, ${uMax.toFixed(2)}]</p>
                
                <h4>Fuzzified Series</h4>
                <table>
                    <tr><th>Index</th><th>Value</th><th>Fuzzified</th></tr>
                    ${data.map((v, i) => `<tr><td>t=${i+1}</td><td>${v}</td><td>${fuzzified[i]}</td></tr>`).join('')}
                </table>
                
                <h4>FLRs (Order = ${order})</h4>
                <pre>${flrs.map(f => `${f.antecedent} â†’ ${f.consequent}`).join('\n')}</pre>
                
                <h4>FLRGs</h4>
                <pre>${Object.entries(flrgs).map(([k, v]) => `${k} â†’ ${Array.from(v).join(', ')}`).join('\n')}</pre>
                
                <div class="info-box success">
                    <div class="info-box-title">ğŸ”® Prediction</div>
                    <p>Current state: <strong>${lastAntecedent}</strong></p>
                    <p>FLRG: ${lastAntecedent} â†’ <strong>${prediction}</strong></p>
                    <p>Predicted next value: <strong>${predictedValue}</strong></p>
                </div>
            `;
            
            document.getElementById('fts-result').innerHTML = html;
        }

        // ==========================================
        // INITIALIZATION
        // ==========================================
        document.addEventListener('DOMContentLoaded', function() {
            loadProgress();
            setupCheckboxListeners();
            setupNavigation();
            drawMembershipFunctions();
        });
    </script>
</body>
</html>
